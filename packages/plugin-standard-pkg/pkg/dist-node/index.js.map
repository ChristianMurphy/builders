{"version":3,"file":"index.js","sources":["../dist-src/index.js"],"sourcesContent":["import path from 'path';\nimport fs from 'fs';\nimport { MessageError } from '@pika/types';\nimport { Lint, Build } from 'standard-pkg';\nexport async function beforeJob({ cwd }) {\n    const srcDirectory = path.join(cwd, 'src/');\n    if (!fs.existsSync(srcDirectory)) {\n        throw new MessageError('@pika/pack expects a standard package format, where package source must live in \"src/\".');\n    }\n    if (!fs.existsSync(path.join(cwd, 'src/index.js')) &&\n        !fs.existsSync(path.join(cwd, 'src/index.ts')) &&\n        !fs.existsSync(path.join(cwd, 'src/index.jsx')) &&\n        !fs.existsSync(path.join(cwd, 'src/index.tsx'))) {\n        throw new MessageError('@pika/pack expects a standard package format, where the package entrypoint must live at \"src/index\".');\n    }\n}\nexport async function afterJob({ out, reporter }) {\n    reporter.info('Linting with standard-pkg...');\n    const linter = new Lint(path.join(out, 'dist-src'));\n    await linter.init();\n    linter.summary();\n}\nexport function manifest(newManifest) {\n    newManifest.esnext = newManifest.esnext || 'dist-src/index.js';\n    return newManifest;\n}\nexport async function build({ cwd, out, options, reporter }) {\n    const builder = new Build(path.join(cwd, 'src'), options);\n    await builder.init();\n    await builder.write(path.join(out, '/dist-src/'));\n    reporter.created(path.join(out, 'dist-src', 'index.js'), 'esnext');\n}\n"],"names":["beforeJob","cwd","srcDirectory","path","join","fs","existsSync","MessageError","afterJob","out","reporter","info","linter","Lint","init","summary","manifest","newManifest","esnext","build","options","builder","Build","write","created"],"mappings":";;;;;;;;;;;AAIO,eAAeA,SAAf,CAAyB;EAAEC;CAA3B,EAAkC;QAC/BC,YAAY,GAAGC,IAAI,CAACC,IAAL,CAAUH,GAAV,EAAe,MAAf,CAArB;;MACI,CAACI,EAAE,CAACC,UAAH,CAAcJ,YAAd,CAAL,EAAkC;UACxB,IAAIK,kBAAJ,CAAiB,yFAAjB,CAAN;;;MAEA,CAACF,EAAE,CAACC,UAAH,CAAcH,IAAI,CAACC,IAAL,CAAUH,GAAV,EAAe,cAAf,CAAd,CAAD,IACA,CAACI,EAAE,CAACC,UAAH,CAAcH,IAAI,CAACC,IAAL,CAAUH,GAAV,EAAe,cAAf,CAAd,CADD,IAEA,CAACI,EAAE,CAACC,UAAH,CAAcH,IAAI,CAACC,IAAL,CAAUH,GAAV,EAAe,eAAf,CAAd,CAFD,IAGA,CAACI,EAAE,CAACC,UAAH,CAAcH,IAAI,CAACC,IAAL,CAAUH,GAAV,EAAe,eAAf,CAAd,CAHL,EAGqD;UAC3C,IAAIM,kBAAJ,CAAiB,sGAAjB,CAAN;;;AAGR,AAAO,eAAeC,QAAf,CAAwB;EAAEC,GAAF;EAAOC;CAA/B,EAA2C;EAC9CA,QAAQ,CAACC,IAAT,CAAc,8BAAd;QACMC,MAAM,GAAG,IAAIC,gBAAJ,CAASV,IAAI,CAACC,IAAL,CAAUK,GAAV,EAAe,UAAf,CAAT,CAAf;QACMG,MAAM,CAACE,IAAP,EAAN;EACAF,MAAM,CAACG,OAAP;;AAEJ,AAAO,SAASC,QAAT,CAAkBC,WAAlB,EAA+B;EAClCA,WAAW,CAACC,MAAZ,GAAqBD,WAAW,CAACC,MAAZ,IAAsB,mBAA3C;SACOD,WAAP;;AAEJ,AAAO,eAAeE,KAAf,CAAqB;EAAElB,GAAF;EAAOQ,GAAP;EAAYW,OAAZ;EAAqBV;CAA1C,EAAsD;QACnDW,OAAO,GAAG,IAAIC,iBAAJ,CAAUnB,IAAI,CAACC,IAAL,CAAUH,GAAV,EAAe,KAAf,CAAV,EAAiCmB,OAAjC,CAAhB;QACMC,OAAO,CAACP,IAAR,EAAN;QACMO,OAAO,CAACE,KAAR,CAAcpB,IAAI,CAACC,IAAL,CAAUK,GAAV,EAAe,YAAf,CAAd,CAAN;EACAC,QAAQ,CAACc,OAAT,CAAiBrB,IAAI,CAACC,IAAL,CAAUK,GAAV,EAAe,UAAf,EAA2B,UAA3B,CAAjB,EAAyD,QAAzD;;;;;;;;"}